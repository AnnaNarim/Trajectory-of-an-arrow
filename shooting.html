<!DOCTYPE html>
<html>
<head>
	<title>Shooting</title>
</head>
<style>
#container {
  width: 600px;
  height: 400px;
  position: relative;
  background: #93b7f2;
}
#tank {
  width: 30px;
  height: 30px;
  position: fixed;
  top: 170px;
  background: black;
}
/*#bullet {
	width: 10px;
	height: 5px;
	background: red;
	position: fixed;

}*/
#path {
	height: 2px;
	width: 580px;
	background: grey;
	position: relative;
	
	
}
</style>
<body>
	<div id="container" onmousedown="mouseDown(event)" onmouseup="mouseUp()"> 
		<div id='power'>POWER</div>
		<div id='amount'></div>
		
		<div id="tank">
			
				<!-- <div id="path"></div> -->
			
		</div>
	</div>
	<script>
		class Bullet {
			constructor(){
				this.x = 38;
				this.y = 180;
				const container = document.getElementById('container');
				const bullet = document.createElement("div");
				bullet.style.position = 'fixed';
				bullet.style.width = '10px';
				bullet.style.height = '5px';
				bullet.style.background = 'red';
				bullet.style.left = this.x + 'px';
		        bullet.style.top = this.y + 'px'; 
		        bullet.setAttribute("id", "bullet");
		        container.appendChild(bullet)
			}
			setEndpoint(endpointX, endpointY){
				this.targetX = endpointX;
				this.targetY = endpointY;
			}
			mainComp(power){
				this.power = power;
				const dist = Math.round(Math.sqrt(Math.pow(this.x - this.targetX, 2) + Math.pow(this.y - this.targetY, 2)));
				 // yndhanur chanaparhy 
				this.cos = parseFloat(((Math.sqrt(Math.pow(this.x - this.targetX, 2)))/dist).toFixed(2));
			    this.sin = parseFloat(((Math.sqrt(Math.pow(this.y - this.targetY, 2)))/dist).toFixed(2));
			    //console.log('cos, sin', this.cos, this.sin, dist)
			    this.time = Math.round(dist/power);//yndhanur jamanaky skzbnaketic tiraxin
			}
			computation(){
				const t = 0.5;
				let hDist = this.power * t;
			    let hDiff  = parseInt((4.9 * t * t ).toFixed(2));
			    console.log('4.9 * t * t', 4.9 * t * t, this.y, this.sin)
			    // this.x +=  parseInt((hDist*this.cos).toFixed(2));
			    // this.y +=  parseInt((hDiff*this.sin).toFixed(2));
			    this.x = this.x + hDist;
			    this.y = this.y + hDiff;

			    //console.log('this', this.x, this.y)
			}
			animate(){
			    let halfTime = 0.5;
				const t = 0.5;
			    const b = document.getElementById('bullet');
				const selfo = this;
				let count = 0;

			    const id = setInterval(animate, 50);

		    	function animate() {
			    	if(halfTime>selfo.time || selfo.x > selfo.targetX ){
			    		clearInterval(id);
			    		selfo.power = 0;
			            document.getElementById('amount').innerHTML = '';
			    	}
			    	selfo.computation();

			    	console.log("coordinates:", selfo.x, selfo.y)
					b.style.left = selfo.x + 'px';
			        b.style.top = selfo.y + 'px'; 

			    	halfTime+=t
			   	}
			}
			
		}

		let bullet = new Bullet();
		let power = 20;
		let interval;
		const POWER_TIMER = 100;



		const mouseDown = function(event) {
			bullet.setEndpoint(event.clientX, event.clientY);
			const amount = document.getElementById('amount');
			interval = setInterval(function(){ 
				power++;
				amount.innerHTML = "";
				amount.innerHTML = power;
			}, POWER_TIMER);
		}

		const mouseUp = function(){
			clearInterval(interval);
			bullet.mainComp(power);
		   	bullet.animate();
		}
	</script>
</body>
</html>